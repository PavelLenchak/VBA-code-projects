# VBA

Примеры реализованных проектов в рамках работы на ПАО "Газпронефть-ОНПЗ"

1) Выгрузка ШАБЛОН, Passport, ICTE
  Скрипт необходим для формирования общего списка элементов оборудования, которому проводилась проверка толщины стенок. Метод использования основан на указании папки, которая содержит шаблоны толщинометрии. Дальше пользователь вводит каким столбцам общей таблицы соответствуют столбцы в шаблоне (т.к. название и расположение столбцов могут отличаться в разный момент времени). Следующим шагом производится дальнейшее формирование и форматирование общих данных, согласно заявленным требованиям.
  Методы:
    Выгрузить шаблоны - сформировать общую таблицу с данными
    Сформировать шаблоны - создать отдельный шаблон для каждой линии (обратное действие "Выгрузке")
    Passport, ICTE, Толщинометрия - создать отдельные книги Excel с возможностью загрузки каждой в необходимое ПО
    Сформировать список папок - создаётся отдельная книга Excel с полным списком папок / подпапок в указанной директории (с гиперссылками)
  
  
2) Парсинг сайта сварщиков
  Скрипт позволяет формировать реестр сварщиков компании НАКС в удобный для дальнейшей обработки и учёта необходимой информации. Метод использования основан на заполнении списка "Клеймо" (у каждого сварщика свой уникальный номер) и нажатии на кнопку действия. В дальнейшем производится сброс, установка фильтра на сайте НАКС и выгрузка данных по каждому сварщику. Т.к. дополнительная информация является динамической (появляется при нажатии "подробнее"), скрипт сначала выгружает табличные данные, затем пробегает по каждому элементу сертификата. Свойство "Сохранять сертификаты в Excel" позволяет сохранять каждый сертификат в отдельную книгу (формируется отдельная директория) и на каждую книгу создаётся гиперссылка в 13 столбце.
  Методы:
    Выгрузить данные - спарсить данные с сайта, которые соответсвуют каждому значению Клейма в списке
    Clear content - очищает сформированный список (значения и форматирование)
  
  
3) Реестр сварщиков
  Файл с примером использования оптимизации документооборота с помощью формирования допускных листов и отдельных реестров по каждой организации
  Методы:
    Создать лист сварщика - создаётся отдельная книга Excel с данными сварщика, которая сохраняется в отдельную директорию (сортируется по дате создания)
    Создать резервную копию - создаётся копия книги в папку Резервные копии, которая создаётся только при первом нажатии (сортируется по дате и времени)
    Разбить реестр по файлам организации - позволяет сформировать реестры сварщиков по отдельным организациям. Уникальное название каждной организации необходимо поместить в список на листе "Данные" (на каждую книгу устанавливается пароль, указанный в ячейке на листе)
